{% extends "exercise_base.html" %}

{% block title %}Dashboard - Exercise Tracker{% endblock %}

{% block content %}
<div class="animation-fadeIn">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="display-5 text-center mb-0">
                <i class="fas fa-dumbbell text-primary"></i> Fitness Dashboard
            </h1>
            <p class="text-center text-muted">Track your fitness journey and stay motivated</p>
        </div>
    </div>

    <!-- Quick Stats -->
    <div class="row mb-4">
        <div class="col-md-3 col-sm-6 mb-3">
            <div class="stats-card">
                <div class="stats-number">{{ stats.total_workouts }}</div>
                <div class="stats-label">
                    <i class="fas fa-calendar-check"></i> Workouts This Month
                </div>
            </div>
        </div>
        <div class="col-md-3 col-sm-6 mb-3">
            <div class="stats-card" style="background: var(--success-gradient);">
                <div class="stats-number">{{ stats.total_duration | format_duration }}</div>
                <div class="stats-label">
                    <i class="fas fa-clock"></i> Total Time
                </div>
            </div>
        </div>
        <div class="col-md-3 col-sm-6 mb-3">
            <div class="stats-card" style="background: var(--warning-gradient);">
                <div class="stats-number">{{ stats.total_exercises }}</div>
                <div class="stats-label">
                    <i class="fas fa-list-check"></i> Exercises Done
                </div>
            </div>
        </div>
        <div class="col-md-3 col-sm-6 mb-3">
            <div class="stats-card" style="background: var(--info-gradient);">
                <div class="stats-number">{{ "%.1f" | format(stats.workout_frequency) }}</div>
                <div class="stats-label">
                    <i class="fas fa-chart-line"></i> Workouts/Day
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">
                        <i class="fas fa-bolt text-warning"></i> Quick Actions
                    </h5>
                    <div class="row">
                        <div class="col-md-3 col-sm-6 mb-2">
                            <a href="{{ url_for('new_workout') }}" class="btn btn-gradient w-100">
                                <i class="fas fa-play"></i> Start Workout
                            </a>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-2">
                            <a href="{{ url_for('add_exercise') }}" class="btn btn-success-gradient w-100">
                                <i class="fas fa-plus"></i> Add Exercise
                            </a>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-2">
                            <a href="{{ url_for('exercises') }}" class="btn btn-warning-gradient w-100">
                                <i class="fas fa-search"></i> Browse Exercises
                            </a>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-2">
                            <a href="{{ url_for('progress') }}" class="btn btn-info-gradient w-100">
                                <i class="fas fa-chart-bar"></i> View Progress
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Recent Workouts -->
        <div class="col-md-8 mb-4">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">
                        <i class="fas fa-history text-primary"></i> Recent Workouts
                    </h5>
                    <a href="{{ url_for('workouts') }}" class="btn btn-outline-primary btn-sm">View All</a>
                </div>
                <div class="card-body">
                    {% if recent_workouts %}
                        {% for workout in recent_workouts %}
                            <div class="workout-card card mb-3">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="card-title mb-1">
                                                <i class="fas fa-calendar"></i> 
                                                {{ workout.date | format_date }}
                                            </h6>
                                            <p class="card-text">
                                                <span class="badge badge-custom me-2">
                                                    {{ workout.exercises | length }} exercises
                                                </span>
                                                {% if workout.duration %}
                                                    <span class="badge badge-custom me-2">
                                                        <i class="fas fa-clock"></i> {{ workout.duration | format_duration }}
                                                    </span>
                                                {% endif %}
                                            </p>
                                            {% if workout.notes %}
                                                <p class="text-muted small mb-0">{{ workout.notes[:50] }}...</p>
                                            {% endif %}
                                        </div>
                                        <div class="col-md-4 text-end">
                                            <a href="{{ url_for('view_workout', workout_id=workout.id) }}" 
                                               class="btn btn-outline-primary btn-sm">
                                                <i class="fas fa-eye"></i> View Details
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    {% else %}
                        <div class="text-center py-4">
                            <i class="fas fa-dumbbell fa-3x text-muted mb-3"></i>
                            <h5 class="text-muted">No workouts yet!</h5>
                            <p class="text-muted">Start your fitness journey by logging your first workout.</p>
                            <a href="{{ url_for('new_workout') }}" class="btn btn-gradient">
                                <i class="fas fa-plus"></i> Start First Workout
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Muscle Groups & Stats -->
        <div class="col-md-4 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-chart-pie text-success"></i> Muscle Groups Trained
                    </h5>
                </div>
                <div class="card-body">
                    {% if stats.muscle_groups_trained %}
                        <canvas id="muscleGroupChart" width="400" height="300"></canvas>
                    {% else %}
                        <div class="text-center py-3">
                            <i class="fas fa-chart-pie fa-2x text-muted mb-2"></i>
                            <p class="text-muted">No data yet. Start working out to see your muscle group distribution!</p>
                        </div>
                    {% endif %}
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-fire text-danger"></i> Exercise Types
                    </h5>
                </div>
                <div class="card-body">
                    {% if stats.exercise_types %}
                        {% for exercise_type, count in stats.exercise_types.items() %}
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span>{{ exercise_type }}</span>
                                <span class="badge badge-custom">{{ count }}</span>
                            </div>
                        {% endfor %}
                    {% else %}
                        <div class="text-center py-2">
                            <p class="text-muted">No exercise data available yet.</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Motivational Section -->
    <div class="row">
        <div class="col-12">
            <div class="card" style="background: var(--primary-gradient); color: white;">
                <div class="card-body text-center">
                    <h4><i class="fas fa-trophy"></i> Keep Going!</h4>
                    <p class="mb-0" id="motivational-quote">
                        "The groundwork for all happiness is good health." - Leigh Hunt
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Muscle Group Chart
document.addEventListener('DOMContentLoaded', function() {
    const muscleGroupData = {{ stats.muscle_groups_trained | tojson }};
    
    if (muscleGroupData && Object.keys(muscleGroupData).length > 0) {
        const ctx = document.getElementById('muscleGroupChart').getContext('2d');
        
        new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: Object.keys(muscleGroupData),
                datasets: [{
                    data: Object.values(muscleGroupData),
                    backgroundColor: [
                        '#667eea',
                        '#764ba2',
                        '#f093fb',
                        '#f5576c',
                        '#4facfe',
                        '#00f2fe',
                        '#43e97b',
                        '#38f9d7'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            padding: 15,
                            usePointStyle: true
                        }
                    }
                }
            }
        });
    }
});

// Motivational quotes rotation
const quotes = [
    "The groundwork for all happiness is good health. - Leigh Hunt",
    "Take care of your body. It's the only place you have to live. - Jim Rohn",
    "Exercise is a celebration of what your body can do. Not a punishment for what you ate.",
    "The successful warrior is the average man with laser-like focus. - Bruce Lee",
    "Your body can do it. It's your mind that you have to convince.",
    "Strength doesn't come from what you can do. It comes from overcoming the things you once thought you couldn't.",
    "The only bad workout is the one that didn't happen.",
    "Fitness is not about being better than someone else. It's about being better than you used to be."
];

function rotateQuote() {
    const quoteElement = document.getElementById('motivational-quote');
    const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
    quoteElement.textContent = randomQuote;
}

// Rotate quote every 10 seconds
setInterval(rotateQuote, 10000);
</script>
{% endblock %}